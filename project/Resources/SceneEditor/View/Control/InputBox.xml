<!-- params: Text -->
<Node Name="box" X="{ @X }" Y="{ @Y }" Width="280" Height="250">
	<Import Module="Control.TextField"/>
	<Import Module="Control.CircleButton"/>

	<Action>
		<Spawn Name="show">
			<Opacity Time="0.3" Alpha="1"/>
			<Scale Time="0.3" X="1" Y="1" Ease="OutBack"/>
		</Spawn>
	</Action>

	<Layer Name="mask" X="{ $X }" Y="{ $Y }"
		SwallowTouches="True" TouchEnabled="True"
		TouchPriority="{ CCMenu.DefaultHandlerPriority-998 }"/>

	<DrawNode X="{ $X }" Y="{ $Y }">
		<Polygon FillColor="0xe5100000" BorderWidth="0.5" BorderColor="0x88ffafaf">
			<Vec2 X="-140" Y="-125"/>
			<Vec2 X="140" Y="-125"/>
			<Vec2 X="140" Y="125"/>
			<Vec2 X="-140" Y="125"/>
		</Polygon>

		<LabelTTF Name="title" Text="{ text }" FontName="Arial" FontSize="24" X="0" Y="76" Color="0x00ffff" AntiAlias="False"/>

		<DrawNode Name="frame">
			<Polygon FillColor="0x0" BorderWidth="0.5" BorderColor="0xff00ffff">
				<Vec2 X="-120" Y="-18"/>
				<Vec2 X="120" Y="-18"/>
				<Vec2 X="120" Y="18"/>
				<Vec2 X="-120" Y="18"/>
			</Polygon>
		</DrawNode>
		<TextField Name="textField" X="0" Y="-9" FontSize="16" Limit="15" Ref="True">
			<Slot Name="TextChanged" Args="item">
				item.opacity = 0.3
				frame.opacity = 0.3
				if item.text ~= "" then
					item:detachWithIME()
				end
			</Slot>
		</TextField>

		<Menu Name="activateArea" Width="120" Height="50" SwallowTouches="True"
			TouchPriority="{ CCMenu.DefaultHandlerPriority-999 }" Ref="True">
			<MenuItem X="{ $X }" Y="{ $Y }" Width="120" Height="50">
				<Slot Name="Tapped">
					textField:attachWithIME()
					textField.opacity = 1
					frame.opacity = 1
				</Slot>
			</MenuItem>
		</Menu>

		<Menu Name="opMenu" Y="-76" Width="130" Height="60" SwallowTouches="True"
			TouchPriority="{ CCMenu.DefaultHandlerPriority-1000 }" Ref="True">
			<CircleButton Name="okBtn" X="30" Y="30" Radius="30" FontSize="17" Text="OK" Ref="True">
				<DrawNode X="30" Y="30">
					<Dot X="0" Y="0" Radius="30" Color="0x22ffffff"/>
				</DrawNode>
			</CircleButton>
			<CircleButton Name="cancelBtn" X="100" Y="30" Radius="30" FontSize="17" Text="Cancel" Ref="True">
				<DrawNode X="30" Y="30">
					<Dot X="0" Y="0" Radius="30" Color="0x22ffffff"/>
				</DrawNode>
			</CircleButton>
		</Menu>
	</DrawNode>

	<Slot Name="Entered">
		box.opacity = 0
		box.scaleX = 0
		box.scaleY = 0
		box:perform(show)
	</Slot>
</Node>
